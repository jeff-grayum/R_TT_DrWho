---
title: "Dr. Who"
author: "Jeff Grayum"
date: "12/12/2021"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Loading libraries.
```{r}
library(tidyverse)
library(tidytuesdayR)
library(scales)
library(ggthemes)
```

Loading data.
```{r}
tuesdata <- tidytuesdayR::tt_load('2021-11-23')

writers <- tuesdata$writers

directors <- tuesdata$directors

episodes <- tuesdata$episodes %>%
  select(-serial_title) %>%
  fill(season_number) %>%
  mutate(episode = paste0(season_number, ".", coalesce(as.character(episode_number, "X")), " ", episode_title),
         episode = fct_reorder(episode, first_aired),
         episode_title = fct_reorder(episode_title, first_aired))

imdb <- tuesdata$imdb
```

First look.
```{r}
episodes %>%
  view()

episodes %>%
  count(type)

episodes %>%
  filter(season_number <= 4) %>%
  ggplot(aes(episode_title, uk_viewers, fill = factor(season_number))) +
  geom_col() +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(x = "",
       y = "# of UK Viewers (millions)",
       fill = "Season",
       title = "UK Viewers per Episode of Dr. Who (Davies years)")

episodes %>%
  filter(season_number <= 4) %>%
  ggplot(aes(episode_title, rating)) +
  geom_line(group = 1) +
  geom_point(aes(color = factor(season_number))) +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(x = "",
       y = "Ave. Rating (IMDb)",
       color = "Season",
       title = "IMDb ratings of Dr. Who episode (Davies years)")


episodes %>%
  ggplot(aes(as.numeric(episode_title), rating)) +
  geom_line(group = 1) +
  geom_point(aes(color = factor(season_number))) +
  geom_smooth(method = "loess") +
  geom_text(aes(label = episode_title), hjust = 1, vjust = 1, check_overlap = TRUE) +
  theme_tufte() +
  theme(axis.text.x = element_blank()) +
  labs(x = "",
       y = "Ave. Rating (IMDb)",
       color = "Season",
       title = "IMDb ratings of Dr. Who episodes")


```

